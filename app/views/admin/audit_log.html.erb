<h1>Audit logs</h1>

<div class="category-meta">
  <h3><%= pluralize(@logs.count, 'log') %></h3>
  <div class="button-list is-gutterless">
    <% classes = 'button is-outlined is-muted' %>
    <%= link_to 'Age', query_url(sort: 'age'),
                class: "#{classes} #{params[:sort] == 'age' || params[:sort].nil? ? 'is-active' : ''}" %>
    <%= link_to 'Type', query_url(sort: 'type'),
                class: "#{classes} #{params[:sort] == 'type' ? 'is-active' : ''}" %>
    <%= link_to 'Event', query_url(sort: 'event'),
                class: "#{classes} #{params[:sort] == 'event' ? 'is-active' : ''}" %>
    <%= link_to 'Related', query_url(sort: 'related'),
                class: "#{classes} #{params[:sort] == 'related' ? 'is-active' : ''}" %>
    <%= link_to 'User', query_url(sort: 'user'),
                class: "#{classes} #{params[:sort] == 'user' ? 'is-active' : ''}" %>
  </div>
</div>

<table class="table is-full-width is-with-hover">
  <thead>
    <tr>
      <th>Type</th>
      <th>Event</th>
      <th>User</th>
      <th>Related</th>
      <th>Comment</th>
      <th>Created</th>
    </tr>
  </thead>
  <tbody>
    <% @logs.each do |log| %>
      <tr>
        <td><%= log.log_type.humanize %></td>
        <td><%= log.event_type.humanize %></td>
        <td><%= log.user.present? ? link_to(log.user.username, user_path(log.user)) : '' %></td>
        <td>
          <% if log.related.present? %>
            <%= log.related_type %> #<%= log.related_id %>
            <% if log.related.respond_to? :name %>
              (<%= log.related.name %>)
            <% end %>
          <% end %>
        </td>
        <td><%= log.comment %></td>
        <td title="<%= log.created_at.iso8601 %>"><%= time_ago_in_words(log.created_at) %> ago</td>
      </tr>
    <% end %>
  </tbody>
</table>